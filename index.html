<html lang="en">
  <head>
    <title>Polish Cyrillic Transcriber</title>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="icon.svg">
  </head>
  <body>
    <div class="interface">
      <div class="two"></div>
      <div class="two">
        <h3>POLISH CYRILLIC TRANSCRIBER</h3>
        <h4>A Cyrillic Orthography for the Polish Language</h4>
      </div>
      <div class="one"></div>
      <div>
        <p>Type or paste Polish text below:</p>
        <textarea rows="5" id="input" placeholder="Wszyscy ludzie rodzą się wolni i równi w swojej godności i prawach..." oninput="transcribe()"></textarea>
        <!-- W Szczebrzeszynie chrząszcz brzmi w trzcinie... -->
      </div>
      <div class="one"></div>
      <div>
        <p>Result:</p>
        <textarea rows="5" id="output"></textarea>
      </div>
      <div class="one"></div>
      <div class="two">
        <input type="radio" name="orthography" value="russian" checked="">
        Russian system
        <br><br>
        <input type="radio" name="orthography" value="ukrainian">
        Ukrainian system
      </div>
      <div class="two"></div>
      <script src="script.js"></script>
      <div id="try" data-svgSource="icon.svg" class=bigimg>
          <canvas>
            <img width="100" height="100" />
            <img width="400" height="400" />
          </canvas>
      </div>
      <script type="text/javascript">
        convert('#try');
        function convert(selectors){
          [].forEach.call(document.querySelectorAll(selectors),function(div){
            try{
              var sourceImage;
              var imgs = div.querySelectorAll('img'),
                  svg  = div.querySelector('svg'),
                  can  = div.querySelector('canvas'),
                  ctx  = can.getContext('2d');
              can.width  = imgs[1].getAttribute('width')*1;
              can.height = imgs[1].getAttribute('height')*1;    
              if (svg){
                imgs[0].src = svgDataURL(svg);
                sourceImage = new Image;
                sourceImage.width  = can.width;
                sourceImage.height = can.height;
              }else{
                sourceImage = imgs[0];
              }
              sourceImage.onload = function(){
                ctx.drawImage(sourceImage,0,0,imgs[1].width,imgs[1].height);
                imgs[1].src = can.toDataURL();
              };
              sourceImage.src = svg ? svgDataURL(svg) : div.getAttribute('data-svgSource');
            }catch(e){ console.log(e) }
          });
        }
        function svgDataURL(svg) {
          var svgAsXML = (new XMLSerializer).serializeToString(svg);
          return "data:image/svg+xml," + encodeURIComponent(svgAsXML);
        }
      </script>
    </div>
  </body>
</html>
